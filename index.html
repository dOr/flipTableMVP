<!DOCTYPE html>
<html>
  <body>
    <canvas id="myCanvas" width="750" height="750" style="border:1px solid #d3d3d3;">
    </canvas>
    <script>
      var last10GammaReadings = [];
      var c = document.getElementById("myCanvas");
      function deviceOrientationListener(e) {
        var ctx = c.getContext("2d");
 
        ctx.clearRect(0, 0, c.width, c.height);
        ctx.fillStyle = "#FF7777";
        ctx.font = "14px Verdana";
        ctx.fillText("Alpha: " + Math.round(e.alpha), 10, 20);
        ctx.beginPath();
        ctx.moveTo(180, 75);
        ctx.lineTo(210, 75);
        ctx.arc(180, 75, 60, 0, e.alpha * Math.PI / 180);
        ctx.fill();
 
        ctx.fillStyle = "#FF6600";
        ctx.fillText("Beta: " + Math.round(e.beta), 10, 140);
        ctx.beginPath();
        ctx.fillRect(180, 150, e.beta, 90);
 
        ctx.fillStyle = "#FF0000";
        ctx.fillText("Gamma: " + Math.round(e.gamma), 10, 270);
        ctx.beginPath();
        ctx.fillRect(90, 340, 180, e.gamma);

        last10GammaReadings.push(Math.floor(e.gamma));
        if(last10GammaReadings.length >10){
          last10GammaReadings.shift();
        }
        ctx.clearRect(10,390,100,100);
        ctx.fillText("last10GammaReadings: " + last10GammaReadings.toString(), 10, 420);
        // ctx.clearRect(10,390,750,100);

        var lastAverage = last10GammaReadings.reduce(function(sum, nextVal){
          return sum+nextVal},0)/last10GammaReadings.length;
        ctx.clearRect(10,480,750,100);
        ctx.fillText("averageOfLast10: " + lastAverage.toString(), 10, 500);
        // ctx.clearRect(10,480,750,100);

      }
 
      if (window.DeviceOrientationEvent) {
        console.log("deviceOrientationSupported");
        window.addEventListener("deviceorientation", deviceOrientationListener);
      } else {
        alert("Sorry, your browser doesn't support Device Orientation");
      }
    </script>
  </body>
</html>